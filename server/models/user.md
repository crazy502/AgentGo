# User 模型设计文档

## 概述

User 模型是AgentGo项目中的核心数据结构，用于管理用户信息。该模型遵循 MVC 架构设计，支持用户的注册、登录、认证和管理功能。

## 字段说明及设计原因

### ID
- **类型**: `int64`
- **标签**: `gorm:"primaryKey" json:"id"`
- **设计原因**: 
  - 作为主键，确保每条用户记录的唯一性
  - 使用自增机制简化ID管理
  - 在数据库层面提供高效的索引和查询性能

### Name
- **类型**: `string`
- **标签**: `gorm:"type:varchar(50)" json:"name"`
- **设计原因**:
  - 存储用户昵称，供用户在系统中显示
  - 限制长度为50字符，平衡存储空间与实用性
  - 通过JSON标签暴露给API，允许前端显示
  - 前端Menu.vue/AIChat.vue会用到

### Email
- **类型**: `string`
- **标签**: `gorm:"type:varchar(100);index" json:"email"`
- **设计原因**:
  - 存储邮箱地址，用于用户注册和验证
  - 添加索引以提高查询性能，特别是在验证邮箱是否已存在时
  - 支持验证码发送功能
  - 限制长度为100字符，满足常见邮箱地址长度需求

### Username
- **类型**: `string`
- **标签**: `gorm:"type:varchar(50);uniqueIndex" json:"username"`
- **设计原因**:
  - 用作唯一用户名，支持用户登录功能
  - 设置唯一索引，确保用户名不重复
  - 与邮箱地址区分，提供多种登录方式
  - 限制长度为50字符，保持合理长度

### Password
- **类型**: `string`
- **标签**: `gorm:"type:varchar(255)" json:"-"`
- **设计原因**:
  - 存储MD5加密后的密码，保护用户密码安全
  - 使用`json:"-"`标签确保密码不会返回给前端，防止安全泄露
  - 限制长度为255字符，足够存储加密后的密码

### CreatedAt/UpdatedAt
- **类型**: `time.Time`
- **标签**: `json:"created_at"` 和 `json:"updated_at"`
- **设计原因**:
  - 自动记录用户创建和更新时间
  - 便于审计和数据管理
  - GORM自动处理时间戳更新

### DeletedAt
- **类型**: `gorm.DeletedAt`
- **标签**: `gorm:"index" json:"-"`
- **设计原因**:
  - 支持软删除功能，保留数据用于审计或恢复
  - 添加索引以提高查询性能
  - 使用`json:"-"`避免将删除状态暴露给前端

## 架构集成

User 模型与以下系统组件集成：

- **Gin 框架**: 处理 HTTP 请求
- **JWT (JSON Web Token)**: 提供身份验证机制
- **Redis**: 缓存验证码和用户会话
- **MySQL**: 存储用户数据
- **GORM**: ORM 层，简化数据库操作

## 安全考虑

- 密码字段使用MD5加密存储
- 密码字段不通过API返回前端
- 用户名和邮箱字段使用索引提高查询效率
- 软删除机制避免敏感数据意外丢失

## 扩展性

User 模型设计具有良好的扩展性，可轻松添加其他用户属性，如头像、角色等，而不会影响现有功能。